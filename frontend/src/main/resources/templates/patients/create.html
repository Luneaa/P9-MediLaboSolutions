<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{fragments/head :: head('Nouveau Patient')}"></head>
<body class="bg-gray-50 flex flex-col min-h-screen">
    <!-- Navigation -->
    <nav th:replace="~{fragments/navbar :: navbar}"></nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 flex-grow">
        <!-- Header with back button -->
        <div class="mb-8 flex items-center justify-between">
            <div>
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Nouveau Patient</h2>
                <p class="text-gray-600">Créer un nouveau dossier patient</p>
            </div>
            <a th:href="@{/patients}" class="inline-flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition">
                <i class="ti ti-x"></i>
                <span>Annuler</span>
            </a>
        </div>

        <!-- Error Message -->
        <div th:if="${error}" class="mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
            <strong class="font-bold">Erreur!</strong>
            <span class="block sm:inline" th:text="${error}"></span>
        </div>

        <!-- Create Form -->
        <form th:action="@{/patients/new}" method="post" th:object="${patient}">
            <!-- Patient Information Card -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden mb-6">
                <div class="bg-primary text-white px-6 py-4">
                    <div class="flex items-center space-x-3">
                        <i class="ti ti-user-plus text-4xl"></i>
                        <div>
                            <h3 class="text-2xl font-bold">Informations du nouveau patient</h3>
                            <p class="text-blue-100 text-sm">Remplissez tous les champs obligatoires</p>
                        </div>
                    </div>
                </div>

                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Personal Information -->
                        <div class="space-y-4">
                            <h4 class="text-lg font-semibold text-gray-800 border-b pb-2 flex items-center space-x-2">
                                <i class="ti ti-id-badge"></i>
                                <span>Informations personnelles</span>
                            </h4>
                            
                            <div class="space-y-4">
                                <!-- Nom -->
                                <div>
                                    <label for="nom" class="text-sm font-medium text-gray-700 mb-1 flex items-center space-x-1">
                                        <i class="ti ti-user"></i>
                                        <span>Nom <span class="text-red-500">*</span></span>
                                    </label>
                                    <input type="text" 
                                           id="nom" 
                                           name="nom"
                                           th:field="*{nom}"
                                           required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                                           placeholder="Nom du patient">
                                </div>

                                <!-- Prénom -->
                                <div>
                                    <label for="prenom" class="text-sm font-medium text-gray-700 mb-1 flex items-center space-x-1">
                                        <i class="ti ti-user"></i>
                                        <span>Prénom <span class="text-red-500">*</span></span>
                                    </label>
                                    <input type="text" 
                                           id="prenom" 
                                           name="prenom"
                                           th:field="*{prenom}"
                                           required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                                           placeholder="Prénom du patient">
                                </div>

                                <!-- Date de naissance -->
                                <div>
                                    <label for="dateNaissance" class="text-sm font-medium text-gray-700 mb-1 flex items-center space-x-1">
                                        <i class="ti ti-calendar"></i>
                                        <span>Date de naissance <span class="text-red-500">*</span></span>
                                    </label>
                                    <input type="date" 
                                           id="dateNaissance" 
                                           name="dateNaissance"
                                           th:field="*{dateNaissance}"
                                           required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
                                </div>

                                <!-- Genre -->
                                <div>
                                    <label for="genre" class="text-sm font-medium text-gray-700 mb-1 flex items-center space-x-1">
                                        <i class="ti ti-gender-bigender"></i>
                                        <span>Genre <span class="text-red-500">*</span></span>
                                    </label>
                                    <select id="genre" 
                                            name="genre"
                                            th:field="*{genre}"
                                            required
                                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
                                        <option value="">-- Sélectionner --</option>
                                        <option value="M">Masculin</option>
                                        <option value="F">Féminin</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Information -->
                        <div class="space-y-4">
                            <h4 class="text-lg font-semibold text-gray-800 border-b pb-2 flex items-center space-x-2">
                                <i class="ti ti-phone"></i>
                                <span>Coordonnées</span>
                            </h4>

                            <div class="space-y-4">
                                <!-- Adresse -->
                                <div>
                                    <label for="adresse" class="text-sm font-medium text-gray-700 mb-1 flex items-center space-x-1">
                                        <i class="ti ti-map-pin"></i>
                                        <span>Adresse</span>
                                    </label>
                                    <input type="text" 
                                           id="adresse" 
                                           name="adresse"
                                           th:field="*{adresse}"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                                           placeholder="Adresse complète">
                                </div>

                                <!-- Téléphone -->
                                <div>
                                    <label for="telephone" class="text-sm font-medium text-gray-700 mb-1 flex items-center space-x-1">
                                        <i class="ti ti-phone"></i>
                                        <span>Téléphone</span>
                                    </label>
                                    <input type="tel" 
                                           id="telephone" 
                                           name="telephone"
                                           th:field="*{telephone}"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                                           placeholder="Numéro de téléphone">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Required fields note -->
                    <div class="mt-6 pt-6 border-t">
                        <p class="text-sm text-gray-600 flex items-center space-x-1">
                            <i class="ti ti-info-circle"></i>
                            <span>Les champs marqués d'un <span class="text-red-500">*</span> sont obligatoires</span>
                        </p>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 flex justify-end space-x-3">
                        <a th:href="@{/patients}" 
                           class="inline-flex items-center space-x-2 px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition">
                            <i class="ti ti-x"></i>
                            <span>Annuler</span>
                        </a>
                        <button type="submit" 
                                class="inline-flex items-center space-x-2 px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-hover transition">
                            <i class="ti ti-device-floppy"></i>
                            <span>Créer le patient</span>
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </main>

    <!-- Footer -->
    <footer th:replace="~{fragments/footer :: footer}"></footer>
</body>
</html>
